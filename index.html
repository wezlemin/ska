<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>PDF Viewer</title>
  <style>
/* Global styling */
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
}

/* Container for PDFs */
.pdf-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: space-between;  /* Distribute the cards evenly */
    margin: 20px;
    gap: 20px; /* Space between items */
}

/* Individual PDF card styling */
.pdf-card {
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    width: calc(33.333% - 20px); /* 3 items per row (33.333% width) with spacing */
    margin: 10px;
    padding: 15px;
    text-align: center;
    cursor: pointer;
    box-sizing: border-box;
}

/* Optional: For small screens, we can make it responsive (2 items per row) */
@media (max-width: 768px) {
    .pdf-card {
        width: calc(50% - 20px); /* 2 items per row on smaller screens */
    }
}

/* Optional: For very small screens (mobile), one item per row */
@media (max-width: 480px) {
    .pdf-card {
        width: 100%; /* 1 item per row on mobile */
    }
}

/* Individual item image styling */
.pdf-card img {
    width: 100%;
    height: auto;
    border-radius: 5px;
}

/* PDF file name styling */
.pdf-card p {
    font-size: 16px;
    color: #333;
    margin-top: 10px;
}

/* Pagination styling */
.pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    margin: 20px 0;
}

.pagination input[type="number"] {
    width: 50px;
    padding: 5px;
    margin: 0 10px;
    border: 1px solid #ccc;
    border-radius: 5px;
    text-align: center;
    font-size: 16px;
}

.pagination button {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 5px 15px;
    border-radius: 5px;
    font-size: 14px;
    cursor: pointer;
}

.pagination button:hover {
    background-color: #0056b3;
}

/* Loading indicator */
.loading {
    text-align: center;
    font-size: 18px;
    color: #007bff;
}

/* Page information styling */
.page-info {
    font-size: 16px;
    margin: 10px;
    text-align: center;
    color: #333;
}

  </style>
</head>
<body>
  <div class="pdf-container" id="pdf-list"></div>
  <div class="pagination" id="pagination-container"></div>
  <div class="page-info" id="page-info"></div>

  <script>
    const perPage = 10;
    let currentPage = 1;
    let maxPages = 1;
    let totalItems = 0;

    // Fetch data from API
    async function fetchPDFs(page = 1) {
      const url = `https://www.scisheets.co.uk/wp-json/wp/v2/media?per_page=${perPage}&page=${page}`;
      const response = await fetch(url);

      // Retrieve the total count from the response headers
      const total = response.headers.get('X-WP-Total');
      totalItems = parseInt(total, 10);

      // Update the maxPages based on the total items
      maxPages = Math.ceil(totalItems / perPage);

      const data = await response.json();

      // Handle the pagination and display of PDFs
      displayPDFs(data);
      updatePageInfo();
      createPagination(); // Ensure pagination is created after fetching data
    }

// Display PDFs
async function displayPDFs(pdfs) {
  const container = document.getElementById('pdf-list');
  container.innerHTML = ''; // Clear previous content

  if (pdfs.length === 0) {
    container.innerHTML = "<p>No files found on this page.</p>";
    return;
  }

  pdfs.forEach(pdf => {
    // Extract the file name from the guid.rendered URL
    const fileName = getFileNameFromUrl(pdf.guid.rendered);

    const pdfItem = document.createElement('div');
    pdfItem.classList.add('pdf-item');

    // Use the provided default image for all files
    const defaultThumbnail = 'https://image2url.com/images/1758150036537-c930c707-ac22-4dec-a483-5fb0f98c13e2.png';

    // Build the HTML structure for each item
    pdfItem.innerHTML = `
      <a href="${pdf.source_url}" target="_blank">
        <img src="${defaultThumbnail}" alt="${fileName}" />
      </a>
      <p>${fileName}</p> <!-- Use the extracted file name -->
    `;

    // Append the item to the container
    container.appendChild(pdfItem);
  });
}

// Helper function to extract the file name from the URL
function getFileNameFromUrl(url) {
  const urlParts = url.split('/');
  return urlParts[urlParts.length - 1]; // Get the last part of the URL, which is the file name
}


    // Add pagination controls
    function createPagination() {
      const paginationContainer = document.getElementById('pagination-container');
      paginationContainer.innerHTML = `
        <button onclick="changePage('prev')">Previous</button>
        <input type="number" id="page-input" value="${currentPage}" min="1" max="${maxPages}" onchange="goToPage()" />
        <button onclick="changePage('next')">Next</button>
      `;
    }

    // Update page info (display total pages and current page)
    function updatePageInfo() {
      const pageInfo = document.getElementById('page-info');
      pageInfo.innerHTML = `Page ${currentPage} of ${maxPages} (Total Items: ${totalItems})`;
    }

    // Change page (Previous/Next)
    function changePage(direction) {
      if (direction === 'prev' && currentPage > 1) {
        currentPage--;
      } else if (direction === 'next' && currentPage < maxPages) {
        currentPage++;
      }
      document.getElementById('page-input').value = currentPage;
      fetchPDFs(currentPage);
    }

    // Go to a specific page
    function goToPage() {
      const inputPage = document.getElementById('page-input').value;
      const pageNum = parseInt(inputPage);
      if (pageNum >= 1 && pageNum <= maxPages) {
        currentPage = pageNum;
        fetchPDFs(currentPage);
      } else {
        alert("Invalid page number");
      }
    }

    // Initialize: Load first page
    fetchPDFs(currentPage);
  </script>
</body>
</html>
